#!/bin/bash

#          _____                    _____                    _____                    _____                    _____                    _____                    _____                    _____                    _____          
#         /\    \                  /\    \                  /\    \                  /\    \                  /\    \                  /\    \                  /\    \                  /\    \                  /\    \         
#        /::\    \                /::\    \                /::\____\                /::\____\                /::\    \                /::\____\                /::\    \                /::\    \                /::\    \        
#       /::::\    \              /::::\    \              /:::/    /               /::::|   |                \:::\    \              /:::/    /               /::::\    \              /::::\    \              /::::\    \       
#      /::::::\    \            /::::::\    \            /:::/    /               /:::::|   |                 \:::\    \            /:::/    /               /::::::\    \            /::::::\    \            /::::::\    \      
#     /:::/\:::\    \          /:::/\:::\    \          /:::/    /               /::::::|   |                  \:::\    \          /:::/    /               /:::/\:::\    \          /:::/\:::\    \          /:::/\:::\    \     
#    /:::/__\:::\    \        /:::/  \:::\    \        /:::/____/               /:::/|::|   |                   \:::\    \        /:::/    /               /:::/  \:::\    \        /:::/__\:::\    \        /:::/__\:::\    \    
#   /::::\   \:::\    \      /:::/    \:::\    \      /::::\    \              /:::/ |::|   |                   /::::\    \      /:::/    /               /:::/    \:::\    \      /::::\   \:::\    \       \:::\   \:::\    \   
#  /::::::\   \:::\    \    /:::/    / \:::\    \    /::::::\____\________    /:::/  |::|   | _____    _____   /::::::\    \    /:::/    /      _____    /:::/    / \:::\    \    /::::::\   \:::\    \    ___\:::\   \:::\    \  
# /:::/\:::\   \:::\    \  /:::/    /   \:::\    \  /:::/\:::::::::::\    \  /:::/   |::|   |/\    \  /\    \ /:::/\:::\    \  /:::/____/      /\    \  /:::/    /   \:::\ ___\  /:::/\:::\   \:::\    \  /\   \:::\   \:::\    \ 
#/:::/  \:::\   \:::\____\/:::/____/     \:::\____\/:::/  |:::::::::::\____\/:: /    |::|   /::\____\/::\    /:::/  \:::\____\|:::|    /      /::\____\/:::/____/     \:::|    |/:::/  \:::\   \:::\____\/::\   \:::\   \:::\____\
#\::/    \:::\   \::/    /\:::\    \      \::/    /\::/   |::|~~~|~~~~~     \::/    /|::|  /:::/    /\:::\  /:::/    \::/    /|:::|____\     /:::/    /\:::\    \     /:::|____|\::/    \:::\  /:::/    /\:::\   \:::\   \::/    /
# \/____/ \:::\   \/____/  \:::\    \      \/____/  \/____|::|   |           \/____/ |::| /:::/    /  \:::\/:::/    / \/____/  \:::\    \   /:::/    /  \:::\    \   /:::/    /  \/____/ \:::\/:::/    /  \:::\   \:::\   \/____/ 
#          \:::\    \       \:::\    \                    |::|   |                   |::|/:::/    /    \::::::/    /            \:::\    \ /:::/    /    \:::\    \ /:::/    /            \::::::/    /    \:::\   \:::\    \     
#           \:::\____\       \:::\    \                   |::|   |                   |::::::/    /      \::::/    /              \:::\    /:::/    /      \:::\    /:::/    /              \::::/    /      \:::\   \:::\____\    
#            \::/    /        \:::\    \                  |::|   |                   |:::::/    /        \::/    /                \:::\__/:::/    /        \:::\  /:::/    /               /:::/    /        \:::\  /:::/    /    
#             \/____/          \:::\    \                 |::|   |                   |::::/    /          \/____/                  \::::::::/    /          \:::\/:::/    /               /:::/    /          \:::\/:::/    /     
#                               \:::\    \                |::|   |                   /:::/    /                                     \::::::/    /            \::::::/    /               /:::/    /            \::::::/    /      
#                                \:::\____\               \::|   |                  /:::/    /                                       \::::/    /              \::::/    /               /:::/    /              \::::/    /       
#                                 \::/    /                \:|   |                  \::/    /                                         \::/____/                \::/____/                \::/    /                \::/    /        
#                                  \/____/                  \|___|                   \/____/                                           ~~                       ~~                       \/____/                  \/____/         
#
#
echo'                                                                                                                                                                                                                                
    Developed by FCKN_JUDAS
'
# Ваши ключи
WALLET_ADDRESS="SOL:G5MFVuQvYabm9sknjwXi9HcHVLGYnEdiQcsQ3NASP1W3"
POOL_ADDRESS="rx.unmineable.com:443"
ALGORITHM="rx"
REF_CODE="8s32-cp81"

# Версия XMRig для скачивания (пример, смотрите релизы на GitHub)
XMRIG_VERSION="6.20.0" # Или другая нужная вам версия

# Архитектура системы (x64 или x86)
ARCH=$(uname -m)
if [[ "$ARCH" == "x86_64" ]]; then
  ARCH="linux-x64"
elif [[ "$ARCH" == "i386" || "$ARCH" == "i686" ]]; then
  ARCH="linux-x86"
else
  echo "Неподдерживаемая архитектура: $ARCH"
  exit 1
fi

# Имя файла XMRig для скачивания
XMRIG_FILENAME="xmrig-${XMRIG_VERSION}-${ARCH}.tar.gz"
XMRIG_DOWNLOAD_URL="https://github.com/xmrig/xmrig/releases/download/v${XMRIG_VERSION}/${XMRIG_FILENAME}"

# Папка для XMRig
XMRIG_FOLDER="xmrig-ready"

# Полный путь к xmrig
XMRIG_PATH="./${XMRIG_FOLDER}/xmrig-6.20.0/xmrig"


# Функция для генерации случайного имени воркера
generate_random_worker_name() {
  head /dev/urandom | tr -dc A-Za-z0-9 | head -c 16 ; echo ''
}

# Анимация загрузки
loading_animation() {
  local frames=("." ".." "...")
  local i=0
  while :; do
    echo -ne "\rЗагрузка ${frames[$i]}"
    i=$(( (i+1) % ${#frames[@]} ))
    sleep 0.2
    [[ -v stop_loading ]] && break
  done
  echo -ne "\r                                  \r" # Очищаем строку
}

# Функция для скачивания XMRig
download_xmrig() {
    # Создаем папку для XMRig
    mkdir -p "$XMRIG_FOLDER"

    # Переходим в папку для XMRig
    cd "$XMRIG_FOLDER" || exit 1

    # Запускаем анимацию загрузки в фоне
    stop_loading=false
    loading_animation &

    # Скачиваем архив XMRig
    wget -q "$XMRIG_DOWNLOAD_URL" -O xmrig.tar.gz

    # Распаковываем архив XMRig
    tar -xf xmrig.tar.gz

    # Удаляем архив
    rm xmrig.tar.gz

    # Останавливаем анимацию загрузки
    stop_loading=true
    wait

    # Возвращаемся в исходную папку
    cd .. || exit 1
}

# Скачиваем XMRig
download_xmrig

# Получаем случайное имя воркера
WORKER_NAME=$(generate_random_worker_name)

# Формируем строку воркера для unMineable
UNMINEABLE_WORKER="$WALLET_ADDRESS.$WORKER_NAME#$REF_CODE"

# Формируем команду для запуска XMRig
XMRIG_COMMAND="$XMRIG_PATH -a $ALGORITHM -o stratum+ssl://$POOL_ADDRESS -p x -u $UNMINEABLE_WORKER"

# Запускаем XMRig и выводим в консоль
$XMRIG_COMMAND

echo "XMRig завершен."
